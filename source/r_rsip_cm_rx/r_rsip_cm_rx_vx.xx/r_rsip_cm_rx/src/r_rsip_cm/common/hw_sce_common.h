/*
* Copyright (c) 2025 Renesas Electronics Corporation and/or its affiliates
*
* SPDX-License-Identifier: BSD-3-Clause
*/

/*******************************************************************************************************************//**
 * @addtogroup SCE
 * @{
 **********************************************************************************************************************/

#ifndef HW_SCE_COMMON_H
#define HW_SCE_COMMON_H

/**********************************************************************************************************************
 * Includes
 **********************************************************************************************************************/
#include "platform.h"
#include "r_rsip_cm_rx_if.h"
#include "r_rsip_rx261_iodefine.h"

/***********************************************************************************************************************
 * Macro definitions
 **********************************************************************************************************************/
/* Change Bits to Bytes */
#define R_SCE_BITS_TO_BYTES(x)     (((x) + 7U) >> 3U)
/* Change Bytes to Bits */
#define R_SCE_BYTES_TO_BITS(x)     ((x) << 3U)
/* Change Words to Bytes */
#define R_SCE_WORDS_TO_BYTES(x)    ((x) << 2U)
/* Change Bytes to Words */
#define R_SCE_BYTES_TO_WORDS(x)    (((x) + 3U) >> 2U)

/***********************************************************************************************************************
 * Typedef definitions
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * Private function prototypes
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * Private global variables
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * Private Functions
 **********************************************************************************************************************/
/**********************************************************************************************************************
* Function Name: change_endian_long
* Description  : Change Endian
* Arguments    : None
* Return Value : None
**********************************************************************************************************************/
uint32_t change_endian_long (uint32_t data);

/**********************************************************************************************************************
* Function Name: HW_SCE_PowerOn
* Description  : SCE Power On
* Arguments    : None
* Return Value : None
**********************************************************************************************************************/
R_BSP_PRAGMA_STATIC_INLINE(HW_SCE_PowerOn)
void HW_SCE_PowerOn(void)
{
#if BSP_FEATURE_TRNG_HAS_MODULE_STOP

    /* RA2 MCU series has separate power control for RNG */
    R_MSTP->MSTPCRC_b.MSTPC28 = 0;
#endif

    /* power on the SCE module */
    MSTP_SECURITY = 0;
}
/**********************************************************************************************************************
* End of function HW_SCE_PowerOn
**********************************************************************************************************************/

/**********************************************************************************************************************
* Function Name: HW_SCE_PowerOff
* Description  : SCE Power Off
* Arguments    : None
* Return Value : None
**********************************************************************************************************************/
R_BSP_PRAGMA_STATIC_INLINE(HW_SCE_PowerOff)
void HW_SCE_PowerOff(void)
{
#if BSP_FEATURE_TRNG_HAS_MODULE_STOP

    /*  Disable hardware TRNG before module stop. */
    /*  Note: Must perform this step BEFORE TRNG module stop, */
    /*  or the TRNG hardware will draw excessive current in power off. */
    R_TRNG->TRNGSCR0_b.SGCEN = 0;

    /*  RA2 MCU series has separate power control for RNG */
    R_MSTP->MSTPCRC_b.MSTPC28 = 1;
#endif

    /* power off the SCE module */
    MSTP_SECURITY = 1;
}
/**********************************************************************************************************************
* End of function HW_SCE_PowerOff
**********************************************************************************************************************/

#endif                                 /* HW_SCE_COMMON_H */

/*******************************************************************************************************************//**
 * @}
 **********************************************************************************************************************/
